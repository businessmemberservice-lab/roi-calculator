<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>55688å°ç£å¤§è»ŠéšŠä¼æ¥­æœƒå“¡ä¹˜è»Šæœå‹™ ROIè¨ˆç®—å™¨</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .logo-section {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .company-logo {
            font-size: 2.5rem;
            font-weight: bold;
            color: #fbbf24;
        }

        .company-name {
            font-size: 2.5rem;
            font-weight: bold;
            color: #fbbf24;
        }

        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        .input-section {
            background: #f8fafc;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e2e8f0;
        }

        .section-title {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: #475569;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            cursor: help;
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 300px;
            background-color: #333;
            color: #fff;
            text-align: left;
            border-radius: 8px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            top: 125%;
            left: 50%;
            margin-left: -150px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            line-height: 1.4;
            text-transform: none;
            letter-spacing: normal;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #374151;
            font-size: 1rem;
            cursor: help;
        }

        .input-row {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-row input {
            flex: 1;
            padding: 12px;
            border: 2px solid #cbd5e1;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            background: white;
            transition: all 0.3s ease;
        }

        .input-row input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .input-row .unit {
            font-weight: bold;
            color: #64748b;
            min-width: 60px;
        }

        .results-section {
            background: #f0f9ff;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #bae6fd;
        }

        .results-section .section-title {
            color: #0c4a6e;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin-bottom: 10px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
            transition: transform 0.3s ease;
        }

        .result-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.2);
        }

        .result-label {
            font-weight: bold;
            color: #374151;
        }

        .result-value {
            font-weight: bold;
            font-size: 1.1rem;
            color: #1e40af;
        }

        .roi-section {
            grid-column: 1 / -1;
            background: #f0fdf4;
            border-radius: 15px;
            padding: 30px;
            border: 2px solid #bbf7d0;
            margin-top: 20px;
        }

        .roi-section .section-title {
            color: #166534;
            font-size: 1.6rem;
            margin-bottom: 25px;
        }

        .roi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .roi-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
            border: 2px solid #dcfce7;
        }

        .roi-card:hover {
            transform: translateY(-5px);
            border-color: #22c55e;
        }

        .roi-card h3 {
            font-size: 1rem;
            color: #6b7280;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .roi-card .value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #166534;
        }

        .scenario-section {
            grid-column: 1 / -1;
            background: #fafafa;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            border: 2px solid #e5e7eb;
        }

        .scenario-section .section-title {
            color: #374151;
            margin-bottom: 20px;
        }

        .scenario-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .scenario-table th {
            background: #6366f1;
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            cursor: help;
        }

        .scenario-table td {
            padding: 12px;
            text-align: center;
            border-bottom: 1px solid #e5e7eb;
        }

        .scenario-table tr:hover {
            background: #f8fafc;
        }

        .positive { color: #16a34a !important; font-weight: bold; }
        .warning { color: #ea580c !important; font-weight: bold; }
        .negative { color: #dc2626 !important; font-weight: bold; }

        .control-buttons {
            grid-column: 1 / -1;
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #64748b 0%, #475569 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(100, 116, 139, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .chart-container {
            grid-column: 1 / -1;
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            border: 2px solid #e5e7eb;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
                padding: 20px;
            }
            
            .company-name, .company-logo {
                font-size: 2rem;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .control-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .roi-grid {
                grid-template-columns: 1fr;
            }
        }

        .highlight-animation {
            animation: highlight 0.8s ease-in-out;
        }

        @keyframes highlight {
            0% { background-color: #f0fdf4; }
            50% { background-color: #bbf7d0; }
            100% { background-color: white; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-section">
                <div class="company-logo">55688</div>
                <div class="company-name">å°ç£å¤§è»ŠéšŠ</div>
            </div>
            <h1>ä¼æ¥­æœƒå“¡ä¹˜è»Šæœå‹™ ROIè¨ˆç®—å™¨</h1>
            <p>å®‰å…¨ãƒ»èˆ’é©ãƒ»è²¼å¿ƒ | å°ˆæ¥­ç‰ˆæŠ•è³‡å ±é…¬ç‡åˆ†æå·¥å…·</p>
        </div>

        <div class="main-content">
            <!-- è¼¸å…¥å€åŸŸ -->
            <div class="input-section">
                <div class="section-title tooltip">ğŸ“Š åŸºæœ¬åƒæ•¸è¨­å®š
                    <span class="tooltiptext">
                        <strong>åŸºæœ¬åƒæ•¸èªªæ˜ï¼š</strong><br>
                        è¨­å®šæ‚¨ä¼æ¥­çš„åŸºæœ¬ä½¿ç”¨æƒ…æ³ï¼ŒåŒ…æ‹¬å“¡å·¥è¦æ¨¡ã€æ­ä¹˜é »ç‡ã€å¹³å‡è»Šè³‡ç­‰é—œéµæ•¸æ“šï¼Œç³»çµ±å°‡æ ¹æ“šé€™äº›åƒæ•¸è¨ˆç®—æŠ•è³‡å ±é…¬ç‡ã€‚
                    </span>
                </div>
                
                <div class="input-group">
                    <label class="tooltip">å…¬å¸å“¡å·¥äººæ•¸
                        <span class="tooltiptext">
                            <strong>å®šç¾©ï¼š</strong>è²´å…¬å¸ç¸½å“¡å·¥æ•¸é‡<br>
                            <strong>ç”¨é€”ï¼š</strong>è©•ä¼°æ•´é«”ä¼æ¥­è¦æ¨¡ï¼Œå½±éŸ¿ç®¡ç†æˆæœ¬è¨ˆç®—
                        </span>
                    </label>
                    <div class="input-row">
                        <input type="number" id="employees" value="100" min="1">
                        <span class="unit">äºº</span>
                    </div>
                </div>

                <div class="input-group">
                    <label class="tooltip">æ¯æœˆä¹˜è»Šæ¬¡æ•¸
                        <span class="tooltiptext">
                            <strong>å®šç¾©ï¼š</strong>ä¼æ¥­æ¯æœˆç¸½æ­ä¹˜è¨ˆç¨‹è»Šæ¬¡æ•¸<br>
                            <strong>å…¬å¼ï¼š</strong>å“¡å·¥å‡ºå·®æ¬¡æ•¸ + å•†å‹™æ¥é€æ¬¡æ•¸ + å…¶ä»–å…¬å‹™ç”¨è»Š<br>
                            <strong>å½±éŸ¿ï¼š</strong>ç›´æ¥å½±éŸ¿ç¸½æˆæœ¬èˆ‡ç¯€çœæ•ˆç›Šè¨ˆç®—
                        </span>
                    </label>
                    <div class="input-row">
                        <input type="number" id="trips" value="50" min="1">
                        <span class="unit">æ¬¡</span>
                    </div>
                </div>

                <div class="input-group">
                    <label class="tooltip">å¹³å‡æ¯è¶Ÿè»Šè³‡
                        <span class="tooltiptext">
                            <strong>å®šç¾©ï¼š</strong>æ¯æ¬¡æ­ä¹˜è¨ˆç¨‹è»Šçš„å¹³å‡è²»ç”¨<br>
                            <strong>è¨ˆç®—æ–¹å¼ï¼š</strong>ç¸½è»Šè³‡ Ã· ç¸½æ­ä¹˜æ¬¡æ•¸<br>
                            <strong>å»ºè­°ï¼š</strong>å¯åƒè€ƒéå»3å€‹æœˆçš„å¹³å‡å€¼
                        </span>
                    </label>
                    <div class="input-row">
                        <input type="number" id="avgCost" value="300" min="1">
                        <span class="unit">å…ƒ</span>
                    </div>
                </div>

                <div class="input-group">
                    <label class="tooltip">æ¯æœˆå ±å¸³è™•ç†æ™‚é–“
                        <span class="tooltiptext">
                            <strong>å®šç¾©ï¼š</strong>è™•ç†è¨ˆç¨‹è»Šå ±å¸³æ‰€éœ€çš„ç¸½å·¥æ™‚<br>
                            <strong>åŒ…å«ï¼š</strong>æ”¶æ“šæ•´ç† + æ ¸éŠ·ç”³è«‹ + å¯©æ ¸ç¢ºèª + ä»˜æ¬¾ä½œæ¥­<br>
                            <strong>å…¬å¼ï¼š</strong>å¹³å‡æ¯ç­†è™•ç†æ™‚é–“ Ã— ä¹˜è»Šæ¬¡æ•¸
                        </span>
                    </label>
                    <div class="input-row">
                        <input type="number" id="adminTime" value="15" min="1">
                        <span class="unit">å°æ™‚</span>
                    </div>
                </div>

                <div class="input-group">
                    <label class="tooltip">è¡Œæ”¿äººå“¡æ™‚è–ª
                        <span class="tooltiptext">
                            <strong>å®šç¾©ï¼š</strong>è™•ç†å ±å¸³æ¥­å‹™çš„è¡Œæ”¿äººå“¡å¹³å‡æ™‚è–ª<br>
                            <strong>è¨ˆç®—ï¼š</strong>æœˆè–ª Ã· å·¥ä½œæ™‚æ•¸ï¼Œæˆ–åƒè€ƒå¸‚å ´è¡Œæƒ…<br>
                            <strong>ç”¨é€”ï¼š</strong>è¨ˆç®—è¡Œæ”¿è™•ç†æˆæœ¬
                        </span>
                    </label>
                    <div class="input-row">
                        <input type="number" id="hourlyRate" value="200" min="1">
                        <span class="unit">å…ƒ/å°æ™‚</span>
                    </div>
                </div>

                <div class="input-group">
                    <label class="tooltip">æœˆçµä¿¡ç”¨é¡åº¦
                        <span class="tooltiptext">
                            <strong>å®šç¾©ï¼š</strong>ä¼æ¥­æœƒå“¡å¯ä½¿ç”¨çš„æœˆçµä»˜æ¬¾é¡åº¦<br>
                            <strong>æ•ˆç›Šï¼š</strong>å»¶å¾Œä»˜æ¬¾æ”¹å–„ç¾é‡‘æµã€çµ±ä¸€å¸³å‹™ç®¡ç†ã€å…æ”¶æ“šæ ¸éŠ·<br>
                            <strong>èªªæ˜ï¼š</strong>åªéœ€æ”¯ä»˜å¯¦éš›æ­ä¹˜çš„è·³è¡¨è»Šè³‡ï¼Œç„¡é¡å¤–æ‰‹çºŒè²»
                        </span>
                    </label>
                    <div class="input-row">
                        <input type="number" id="creditLimit" value="50000" min="1000">
                        <span class="unit">å…ƒ</span>
                    </div>
                </div>
            </div>

            <!-- è¨ˆç®—çµæœå€åŸŸ -->
            <div class="results-section">
                <div class="section-title tooltip">ğŸ’° æˆæœ¬æ•ˆç›Šè¨ˆç®—
                    <span class="tooltiptext">
                        <strong>æˆæœ¬æ•ˆç›Šåˆ†æï¼š</strong><br>
                        æ¯”è¼ƒå‚³çµ±å ±å¸³æ–¹å¼èˆ‡ä¼æ¥­æœƒå“¡æœå‹™çš„æˆæœ¬å·®ç•°ï¼Œé‡åŒ–å„é …ç¯€çœæ•ˆç›Šï¼Œæä¾›æŠ•è³‡æ±ºç­–åƒè€ƒä¾æ“šã€‚
                    </span>
                </div>
                
                <div class="result-item tooltip">
                    <span class="result-label">æ¯æœˆè»Šè³‡ç¸½é¡
                        <span class="tooltiptext">
                            <strong>è¨ˆç®—å…¬å¼ï¼š</strong>æ¯æœˆä¹˜è»Šæ¬¡æ•¸ Ã— å¹³å‡æ¯è¶Ÿè»Šè³‡<br>
                            <strong>èªªæ˜ï¼š</strong>ä¼æ¥­æ¯æœˆè¨ˆç¨‹è»Šæ”¯å‡ºç¸½é‡‘é¡ï¼ˆç´”è·³è¡¨è»Šè³‡ï¼Œç„¡é¡å¤–è²»ç”¨ï¼‰
                        </span>
                    </span>
                    <span class="result-value" id="monthlyTotal">$15,000</span>
                </div>

                <div class="result-item tooltip">
                    <span class="result-label">è³‡é‡‘é€±è½‰æ•ˆç›Š
                        <span class="tooltiptext">
                            <strong>è¨ˆç®—å…¬å¼ï¼š</strong>æ¯æœˆè»Šè³‡ç¸½é¡ Ã— 2.0% Ã· 12<br>
                            <strong>èªªæ˜ï¼š</strong>æœˆçµä»˜æ¬¾å»¶é²30å¤©å¸¶ä¾†çš„ç¾é‡‘æµå„ªåŒ–æ•ˆç›Šï¼ˆå¹´åŒ–2.0%æŠ•è³‡æ”¶ç›Šï¼‰
                        </span>
                    </span>
                    <span class="result-value" id="cashFlowBenefit">$250</span>
                </div>

                <div class="result-item tooltip">
                    <span class="result-label">æ™‚é–“æˆæœ¬ç¯€çœ
                        <span class="tooltiptext">
                            <strong>è¨ˆç®—å…¬å¼ï¼š</strong>æ¯æœˆå ±å¸³è™•ç†æ™‚é–“ Ã— è¡Œæ”¿äººå“¡æ™‚è–ª<br>
                            <strong>èªªæ˜ï¼š</strong>è‡ªå‹•åŒ–å¸³å‹™è™•ç†ç¯€çœçš„äººåŠ›æˆæœ¬
                        </span>
                    </span>
                    <span class="result-value" id="timeSaving">$3,000</span>
                </div>

                <div class="result-item tooltip">
                    <span class="result-label">æ”¶æ“šè™•ç†æˆæœ¬ç¯€çœ
                        <span class="tooltiptext">
                            <strong>è¨ˆç®—å…¬å¼ï¼š</strong>æ¯æœˆä¹˜è»Šæ¬¡æ•¸ Ã— 0.05 Ã— 60å…ƒ<br>
                            <strong>èªªæ˜ï¼š</strong>é›»å­å¸³å–®é¿å…æ”¶æ“šéºå¤±é‡é–‹çš„æˆæœ¬ç¯€çœï¼ˆå‡è¨­5%éºå¤±ç‡ï¼‰
                        </span>
                    </span>
                    <span class="result-value" id="receiptSaving">$150</span>
                </div>

                <div class="result-item" style="border-left: 4px solid #16a34a; background: #f0fdf4;">
                    <span class="result-label tooltip"><strong>æ¯æœˆç¸½ç¯€çœ</strong>
                        <span class="tooltiptext">
                            <strong>è¨ˆç®—å…¬å¼ï¼š</strong>è³‡é‡‘é€±è½‰æ•ˆç›Š + æ™‚é–“æˆæœ¬ç¯€çœ + æ”¶æ“šè™•ç†æˆæœ¬ç¯€çœ<br>
                            <strong>èªªæ˜ï¼š</strong>ä½¿ç”¨ä¼æ¥­æœƒå“¡æœå‹™æ¯æœˆå¯¦éš›ç¯€çœé‡‘é¡ï¼ˆç´”æ•ˆç›Šï¼Œç„¡é¡å¤–æˆæœ¬ï¼‰
                        </span>
                    </span>
                    <span class="result-value positive" id="monthlySaving">$3,400</span>
                </div>

                <div class="result-item" style="border-left: 4px solid #16a34a; background: #f0fdf4;">
                    <span class="result-label tooltip"><strong>å¹´åº¦ç¸½ç¯€çœ</strong>
                        <span class="tooltiptext">
                            <strong>è¨ˆç®—å…¬å¼ï¼š</strong>æ¯æœˆç¸½ç¯€çœ Ã— 12<br>
                            <strong>èªªæ˜ï¼š</strong>å¹´åº¦ç´¯ç©ç¯€çœç¸½é‡‘é¡
                        </span>
                    </span>
                    <span class="result-value positive" id="annualSaving">$40,800</span>
                </div>
            </div>
        </div>

        <!-- ROI åˆ†æå€åŸŸ -->
        <div class="roi-section">
            <div class="section-title tooltip">ğŸ¯ æŠ•è³‡å ±é…¬ç‡åˆ†æ
                <span class="tooltiptext">
                    <strong>æ•ˆç›Šåˆ†æèªªæ˜ï¼š</strong><br>
                    ç”±æ–¼55688ä¼æ¥­æœƒå“¡æœå‹™ç„¡é¡å¤–è²»ç”¨ï¼Œæ­¤åˆ†æä»¥ã€Œæ¯æŠ•å…¥1å…ƒè»Šè³‡å¯ç²å¾—çš„é¡å¤–æ•ˆç›Šã€ç‚ºè¨ˆç®—åŸºæº–ã€‚
                </span>
            </div>
            <div class="roi-grid">
                <div class="roi-card tooltip">
                    <h3>è»Šè³‡æ•ˆç›Šæ¯”
                        <span class="tooltiptext">
                            <strong>è¨ˆç®—å…¬å¼ï¼š</strong>(æ¯æœˆç¸½ç¯€çœ Ã· æ¯æœˆè»Šè³‡ç¸½é¡) Ã— 100%<br>
                            <strong>æ„ç¾©ï¼š</strong>æ¯æ”¯ä»˜100å…ƒè»Šè³‡å¯é¡å¤–ç²å¾—çš„æ•ˆç›Šç™¾åˆ†æ¯”
                        </span>
                    </h3>
                    <div class="value" id="fareEfficiencyRatio">23%</div>
                    <small>é¡å¤–æ•ˆç›Šæ¯”ç‡</small>
                </div>
                <div class="roi-card tooltip">
                    <h3>å¹´åº¦æ•ˆç›Šå€æ•¸
                        <span class="tooltiptext">
                            <strong>è¨ˆç®—å…¬å¼ï¼š</strong>å¹´åº¦ç¸½ç¯€çœ Ã· å¹´åº¦è»Šè³‡ç¸½é¡<br>
                            <strong>æ„ç¾©ï¼š</strong>ç›¸å°æ–¼è»Šè³‡æ”¯å‡ºçš„å¹´åº¦æ•ˆç›Šå€æ•¸
                        </span>
                    </h3>
                    <div class="value" id="annualEfficiencyMultiple">2.7å€</div>
                    <small>å¹´åº¦æ•ˆç›Šå€å¢</small>
                </div>
                <div class="roi-card tooltip">
                    <h3>æˆæœ¬ç¯€çœç‡
                        <span class="tooltiptext">
                            <strong>è¨ˆç®—å…¬å¼ï¼š</strong>(ç¸½ç¯€çœæ•ˆç›Š Ã· (å‚³çµ±è™•ç†æˆæœ¬ + è»Šè³‡)) Ã— 100%<br>
                            <strong>æ„ç¾©ï¼š</strong>ç›¸è¼ƒæ–¼å‚³çµ±ç¾é‡‘å ±å¸³æ–¹å¼çš„ç¸½æˆæœ¬ç¯€çœ
                        </span>
                    </h3>
                    <div class="value" id="costReduction">18%</div>
                    <small>ç›¸è¼ƒå‚³çµ±æ–¹å¼</small>
                </div>
                <div class="roi-card tooltip">
                    <h3>æ•ˆç‡æå‡
                        <span class="tooltiptext">
                            <strong>è¨ˆç®—å…¬å¼ï¼š</strong>(æ™‚é–“æˆæœ¬ç¯€çœ Ã· åŸè™•ç†æˆæœ¬) Ã— 100%<br>
                            <strong>æ„ç¾©ï¼š</strong>è¡Œæ”¿è™•ç†æ•ˆç‡æå‡ç™¾åˆ†æ¯”
                        </span>
                    </h3>
                    <div class="value" id="efficiencyGain">100%</div>
                    <small>è™•ç†æ•ˆç‡ç¿»å€</small>
                </div>
            </div>
        </div>

        <!-- æƒ…å¢ƒåˆ†æ -->
        <div class="scenario-section">
            <div class="section-title">ğŸ“ˆ ä¸åŒä½¿ç”¨é‡æƒ…å¢ƒæ¯”è¼ƒ</div>
            <table class="scenario-table">
                <thead>
                    <tr>
                        <th>é …ç›®</th>
                        <th class="tooltip">ä¿å®ˆä¼°è¨ˆ
                            <span class="tooltiptext">
                                <strong>ä¿å®ˆä¼°è¨ˆæƒ…å¢ƒï¼š</strong><br>
                                â€¢ ä½¿ç”¨é‡è¼ƒä½ï¼ˆç´„ç‚ºä¸€èˆ¬æƒ…æ³çš„60%ï¼‰<br>
                                â€¢ é©ç”¨æ–¼ï¼šå°å‹ä¼æ¥­æˆ–åˆæœŸè©¦ç”¨éšæ®µ<br>
                                â€¢ é¢¨éšªè¼ƒä½ï¼Œä½†æ•ˆç›Šä¹Ÿç›¸å°æœ‰é™
                            </span>
                        </th>
                        <th class="tooltip">ä¸€èˆ¬ç‹€æ³
                            <span class="tooltiptext">
                                <strong>ä¸€èˆ¬ç‹€æ³æƒ…å¢ƒï¼š</strong><br>
                                â€¢ æ ¹æ“šæ‚¨ç›®å‰è¼¸å…¥çš„åƒæ•¸è¨ˆç®—<br>
                                â€¢ æœ€ç¬¦åˆå¯¦éš›ä½¿ç”¨æƒ…æ³<br>
                                â€¢ ä½œç‚ºä¸»è¦æ±ºç­–åƒè€ƒä¾æ“š
                            </span>
                        </th>
                        <th class="tooltip">æ¨‚è§€é æœŸ
                            <span class="tooltiptext">
                                <strong>æ¨‚è§€é æœŸæƒ…å¢ƒï¼š</strong><br>
                                â€¢ ä½¿ç”¨é‡è¼ƒé«˜ï¼ˆç´„ç‚ºä¸€èˆ¬æƒ…æ³çš„160%ï¼‰<br>
                                â€¢ é©ç”¨æ–¼ï¼šå¤§å‹ä¼æ¥­æˆ–æ¥­å‹™æ“´å¼µæœŸ<br>
                                â€¢ æ•ˆç›Šé¡¯è‘—ï¼Œå€¼å¾—ç©æ¥µè©•ä¼°
                            </span>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>ä¹˜è»Šæ¬¡æ•¸</strong></td>
                        <td>30æ¬¡</td>
                        <td id="normalTrips">50æ¬¡</td>
                        <td>80æ¬¡</td>
                    </tr>
                    <tr>
                        <td><strong>æœˆç¸½ç¯€çœé‡‘é¡</strong></td>
                        <td id="conservativeSaving">$2,055</td>
                        <td id="normalSaving">$3,400</td>
                        <td id="optimisticSaving">$5,435</td>
                    </tr>
                    <tr>
                        <td><strong>è»Šè³‡æ•ˆç›Šæ¯”</strong></td>
                        <td id="conservativeROI" class="positive">23%</td>
                        <td id="normalROI" class="positive">23%</td>
                        <td id="optimisticROI" class="positive">23%</td>
                    </tr>
                    <tr>
                        <td><strong>å¹´åº¦ç¸½ç¯€çœ</strong></td>
                        <td id="conservativeAnnual">$24,660</td>
                        <td id="normalAnnual">$40,800</td>
                        <td id="optimisticAnnual">$65,220</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- åœ–è¡¨å€åŸŸ -->
        <div class="chart-container">
            <div class="section-title">ğŸ“Š è¦–è¦ºåŒ–åˆ†æåœ–è¡¨</div>
            <canvas id="roiChart" width="400" height="200"></canvas>
        </div>

        <!-- æ§åˆ¶æŒ‰éˆ• -->
        <div class="control-buttons">
            <button class="btn btn-primary" onclick="recalculate()">ğŸ”„ é‡æ–°è¨ˆç®—</button>
            <button class="btn btn-secondary" onclick="resetDefaults()">â†º é‡è¨­é è¨­å€¼</button>
            <button class="btn btn-primary" onclick="generatePDFReport()">ğŸ“Š ç”ŸæˆPDFå ±å‘Š</button>
        </div>
    </div>

    <script>
        // å…¨åŸŸè®Šæ•¸
        let roiChart;
        
        // è‡ªå‹•è¨ˆç®—åŠŸèƒ½
        const inputs = ['employees', 'trips', 'avgCost', 'adminTime', 'hourlyRate', 'creditLimit'];
        
        inputs.forEach(id => {
            document.getElementById(id).addEventListener('input', calculateROI);
        });

        function formatNumber(num) {
            return new Intl.NumberFormat('zh-TW', {
                style: 'currency',
                currency: 'TWD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(num).replace('NT

        function updateChart() {
            const ctx = document.getElementById('roiChart').getContext('2d');
            
            // ç²å–ç•¶å‰æ•¸æ“š
            const trips = parseFloat(document.getElementById('trips').value);
            const avgCost = parseFloat(document.getElementById('avgCost').value);
            const adminTime = parseFloat(document.getElementById('adminTime').value);
            const hourlyRate = parseFloat(document.getElementById('hourlyRate').value);
            
            const scenarios = [
                { trips: Math.round(trips * 0.6), label: 'ä¿å®ˆä¼°è¨ˆ' },
                { trips: trips, label: 'ä¸€èˆ¬ç‹€æ³' },
                { trips: Math.round(trips * 1.6), label: 'æ¨‚è§€é æœŸ' }
            ];
            
            const data = scenarios.map(scenario => {
                const monthlyTotal = scenario.trips * avgCost;
                const cashFlow = monthlyTotal * 0.02;
                const timeSave = adminTime * hourlyRate;
                const receiptSave = scenario.trips * 0.05 * 60;
                const monthlySave = cashFlow + timeSave + receiptSave;
                return monthlySave;
            });

            if (roiChart) {
                roiChart.destroy();
            }

            roiChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: scenarios.map(s => s.label),
                    datasets: [{
                        label: 'æ¯æœˆç¸½ç¯€çœé‡‘é¡ (å…ƒ)',
                        data: data,
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(168, 85, 247, 0.8)'
                        ],
                        borderColor: [
                            'rgb(59, 130, 246)',
                            'rgb(34, 197, 94)',
                            'rgb(168, 85, 247)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ä¸åŒæƒ…å¢ƒä¸‹çš„æœˆåº¦ç¯€çœæ•ˆç›Šæ¯”è¼ƒ',
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'document.getElementById('hourlyRate').value);
            const serviceFeeRate = parseFloat(document.getElementById('serviceFeeRate').value);
            
            const scenarios = [
                { trips: Math.round(trips * 0.6), label: 'ä¿å®ˆä¼°è¨ˆ' },
                { trips: trips, label: 'ä¸€èˆ¬ç‹€æ³' },
                { trips: Math.round(trips * 1.6), label: 'æ¨‚è§€é æœŸ' }
            ];
            
            const data = scenarios.map(scenario => {
                const monthlyTotal = scenario.trips * avgCost;
                const serviceFee = monthlyTotal * (serviceFeeRate / 100);
                const cashFlow = monthlyTotal * 0.015;
                const timeSave = adminTime * hourlyRate;
                const receiptSave = scenario.trips * 0.05 * 60;
                const monthlySave = cashFlow + timeSave + receiptSave - serviceFee;
                return monthlySave;
            });

            if (roiChart) {
                roiChart.destroy();
            }

            roiChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: scenarios.map(s => s.label),
                    datasets: [{
                        label: 'æ¯æœˆæ·¨ç¯€çœé‡‘é¡ (å…ƒ)',
                        data: data,
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(168, 85, 247, 0.8)'
                        ],
                        borderColor: [
                            'rgb(59, 130, 246)',
                            'rgb(34, 197, 94)',
                            'rgb(168, 85, 247)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ä¸åŒæƒ…å¢ƒä¸‹çš„æœˆåº¦ç¯€çœæ•ˆç›Šæ¯”è¼ƒ',
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return ' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        function recalculate() {
            document.querySelector('.results-section').classList.add('highlight-animation');
            setTimeout(() => {
                document.querySelector('.results-section').classList.remove('highlight-animation');
            }, 800);
            
            calculateROI();
        }

        function resetDefaults() {
            const defaults = {
                'employees': 100,
                'trips': 50,
                'avgCost': 300,
                'adminTime': 15,
                'hourlyRate': 200,
                'serviceFeeRate': 3
            };

            Object.keys(defaults).forEach(id => {
                document.getElementById(id).value = defaults[id];
            });

            calculateROI();
            alert('æ•¸æ“šå·²é‡è¨­ç‚ºé è¨­å€¼ï¼');
        }

        function generatePDFReport() {
            // ç²å–ç•¶å‰æ•¸æ“š
            const employees = document.getElementById('employees').value;
            const trips = document.getElementById('trips').value;
            const avgCost = document.getElementById('avgCost').value;
            const monthlyTotal = document.getElementById('monthlyTotal').textContent;
            const serviceFee = document.getElementById('serviceFee').textContent;
            const monthlySaving = document.getElementById('monthlySaving').textContent;
            const annualSaving = document.getElementById('annualSaving').textContent;
            const monthlyROI = document.getElementById('monthlyROI').textContent;
            const annualROI = document.getElementById('annualROI').textContent;
            
            // è©•ä¼°å»ºè­°
            const roi = parseFloat(monthlyROI);
            let recommendation = '';
            let riskLevel = '';
            
            if (roi >= 500) {
                recommendation = 'å¼·çƒˆå»ºè­°ç«‹å³å°å…¥ï¼æŠ•è³‡å ±é…¬ç‡æ¥µä½³ï¼Œé¢¨éšªæ¥µä½ã€‚';
                riskLevel = 'æ¥µä½é¢¨éšª';
            } else if (roi >= 200) {
                recommendation = 'å»ºè­°ç©æ¥µè©•ä¼°å°å…¥ã€‚æŠ•è³‡å ±é…¬ç‡è‰¯å¥½ï¼Œå…·æœ‰é¡¯è‘—æ•ˆç›Šã€‚';
                riskLevel = 'ä½é¢¨éšª';
            } else if (roi >= 100) {
                recommendation = 'å¯è€ƒæ…®å°å…¥ã€‚æŠ•è³‡å ±é…¬ç‡å°šå¯ï¼Œéœ€è©•ä¼°å…¶ä»–å› ç´ ã€‚';
                riskLevel = 'ä¸­ç­‰é¢¨éšª';
            } else {
                recommendation = 'å»ºè­°å¯©æ…è©•ä¼°ã€‚æŠ•è³‡å ±é…¬ç‡åä½ï¼Œéœ€æ·±å…¥åˆ†ææˆæœ¬æ•ˆç›Šã€‚';
                riskLevel = 'è¼ƒé«˜é¢¨éšª';
            }

            // å‰µå»ºPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // è¨­å®šä¸­æ–‡å­—é«”ï¼ˆä½¿ç”¨å…§å»ºå­—é«”ï¼‰
            doc.setFont('helvetica');
            
            // æ¨™é¡Œ
            doc.setFontSize(20);
            doc.text('55688å°ç£å¤§è»ŠéšŠä¼æ¥­æœƒå“¡ROIåˆ†æå ±å‘Š', 20, 30);
            
            // åŸºæœ¬è³‡è¨Š
            doc.setFontSize(14);
            doc.text('ä¼æ¥­åŸºæœ¬è³‡è¨Š', 20, 50);
            doc.setFontSize(12);
            doc.text(`å“¡å·¥äººæ•¸: ${employees}äºº`, 25, 65);
            doc.text(`æ¯æœˆä¹˜è»Šæ¬¡æ•¸: ${trips}æ¬¡`, 25, 75);
            doc.text(`å¹³å‡æ¯è¶Ÿè»Šè³‡: ${avgCost}`, 25, 85);
            
            // è²¡å‹™åˆ†æ
            doc.setFontSize(14);
            doc.text('è²¡å‹™æ•ˆç›Šåˆ†æ', 20, 105);
            doc.setFontSize(12);
            doc.text(`æ¯æœˆè»Šè³‡ç¸½é¡: ${monthlyTotal}`, 25, 120);
            doc.text(`ç®¡ç†æœå‹™è²»: ${serviceFee}`, 25, 130);
            doc.text(`æ¯æœˆæ·¨ç¯€çœ: ${monthlySaving}`, 25, 140);
            doc.text(`å¹´åº¦æ·¨ç¯€çœ: ${annualSaving}`, 25, 150);
            
            // ROIåˆ†æ
            doc.setFontSize(14);
            doc.text('æŠ•è³‡å ±é…¬ç‡åˆ†æ', 20, 170);
            doc.setFontSize(12);
            doc.text(`æœˆåº¦ROI: ${monthlyROI}`, 25, 185);
            doc.text(`å¹´åº¦ROI: ${annualROI}`, 25, 195);
            doc.text(`é¢¨éšªè©•ä¼°: ${riskLevel}`, 25, 205);
            
            // çµè«–å»ºè­°
            doc.setFontSize(14);
            doc.text('å°ˆæ¥­å»ºè­°', 20, 225);
            doc.setFontSize(12);
            
            // åˆ†è¡Œé¡¯ç¤ºå»ºè­°æ–‡å­—
            const recommendationLines = doc.splitTextToSize(recommendation, 160);
            let yPos = 240;
            recommendationLines.forEach(line => {
                doc.text(line, 25, yPos);
                yPos += 10;
            });
            
            // æ•ˆç›Šæ‘˜è¦
            doc.setFontSize(14);
            doc.text('æ•ˆç›Šæ‘˜è¦', 20, yPos + 10);
            doc.setFontSize(11);
            doc.text('âœ“ è‡ªå‹•åŒ–å¸³å‹™è™•ç†ï¼Œæ¸›å°‘äººåŠ›æˆæœ¬', 25, yPos + 25);
            doc.text('âœ“ æœˆçµä»˜æ¬¾æ–¹å¼ï¼Œæ”¹å–„ç¾é‡‘æµ', 25, yPos + 35);
            doc.text('âœ“ é›»å­å¸³å–®ç®¡ç†ï¼Œæå‡ä½œæ¥­æ•ˆç‡', 25, yPos + 45);
            doc.text('âœ“ å°ˆå±¬å®¢æœæ”¯æ´ï¼Œä¿éšœæœå‹™å“è³ª', 25, yPos + 55);
            
            // å ±å‘Šæ—¥æœŸ
            const today = new Date().toLocaleDateString('zh-TW');
            doc.setFontSize(10);
            doc.text(`å ±å‘Šç”Ÿæˆæ—¥æœŸ: ${today}`, 20, 280);
            doc.text('55688å°ç£å¤§è»ŠéšŠä¼æ¥­æœƒå“¡æœå‹™', 120, 280);
            
            // å„²å­˜PDF
            doc.save('55688ä¼æ¥­æœƒå“¡ROIåˆ†æå ±å‘Š.pdf');
            
            // é¡¯ç¤ºå®Œæˆè¨Šæ¯
            alert('PDFå ±å‘Šå·²æˆåŠŸç”Ÿæˆä¸¦ä¸‹è¼‰ï¼\n\n' + 
                  `æŠ•è³‡å»ºè­°: ${recommendation}\n` +
                  `æœˆåº¦ROI: ${monthlyROI}\n` +
                  `å¹´åº¦ç¯€çœ: ${annualSaving}`);
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            calculateROI();
        });
    </script>
</body>
</html>, '

        function updateChart() {
            const ctx = document.getElementById('roiChart').getContext('2d');
            
            // ç²å–ç•¶å‰æ•¸æ“š
            const trips = parseFloat(document.getElementById('trips').value);
            const avgCost = parseFloat(document.getElementById('avgCost').value);
            const adminTime = parseFloat(document.getElementById('adminTime').value);
            const hourlyRate = parseFloat(document.getElementById('hourlyRate').value);
            const serviceFeeRate = parseFloat(document.getElementById('serviceFeeRate').value);
            
            const scenarios = [
                { trips: Math.round(trips * 0.6), label: 'ä¿å®ˆä¼°è¨ˆ' },
                { trips: trips, label: 'ä¸€èˆ¬ç‹€æ³' },
                { trips: Math.round(trips * 1.6), label: 'æ¨‚è§€é æœŸ' }
            ];
            
            const data = scenarios.map(scenario => {
                const monthlyTotal = scenario.trips * avgCost;
                const serviceFee = monthlyTotal * (serviceFeeRate / 100);
                const cashFlow = monthlyTotal * 0.015;
                const timeSave = adminTime * hourlyRate;
                const receiptSave = scenario.trips * 0.05 * 60;
                const monthlySave = cashFlow + timeSave + receiptSave - serviceFee;
                return monthlySave;
            });

            if (roiChart) {
                roiChart.destroy();
            }

            roiChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: scenarios.map(s => s.label),
                    datasets: [{
                        label: 'æ¯æœˆæ·¨ç¯€çœé‡‘é¡ (å…ƒ)',
                        data: data,
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(168, 85, 247, 0.8)'
                        ],
                        borderColor: [
                            'rgb(59, 130, 246)',
                            'rgb(34, 197, 94)',
                            'rgb(168, 85, 247)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ä¸åŒæƒ…å¢ƒä¸‹çš„æœˆåº¦ç¯€çœæ•ˆç›Šæ¯”è¼ƒ',
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return ' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        function recalculate() {
            document.querySelector('.results-section').classList.add('highlight-animation');
            setTimeout(() => {
                document.querySelector('.results-section').classList.remove('highlight-animation');
            }, 800);
            
            calculateROI();
        }

        function resetDefaults() {
            const defaults = {
                'employees': 100,
                'trips': 50,
                'avgCost': 300,
                'adminTime': 15,
                'hourlyRate': 200,
                'serviceFeeRate': 3
            };

            Object.keys(defaults).forEach(id => {
                document.getElementById(id).value = defaults[id];
            });

            calculateROI();
            alert('æ•¸æ“šå·²é‡è¨­ç‚ºé è¨­å€¼ï¼');
        }

        function generatePDFReport() {
            // ç²å–ç•¶å‰æ•¸æ“š
            const employees = document.getElementById('employees').value;
            const trips = document.getElementById('trips').value;
            const avgCost = document.getElementById('avgCost').value;
            const monthlyTotal = document.getElementById('monthlyTotal').textContent;
            const serviceFee = document.getElementById('serviceFee').textContent;
            const monthlySaving = document.getElementById('monthlySaving').textContent;
            const annualSaving = document.getElementById('annualSaving').textContent;
            const monthlyROI = document.getElementById('monthlyROI').textContent;
            const annualROI = document.getElementById('annualROI').textContent;
            
            // è©•ä¼°å»ºè­°
            const roi = parseFloat(monthlyROI);
            let recommendation = '';
            let riskLevel = '';
            
            if (roi >= 500) {
                recommendation = 'å¼·çƒˆå»ºè­°ç«‹å³å°å…¥ï¼æŠ•è³‡å ±é…¬ç‡æ¥µä½³ï¼Œé¢¨éšªæ¥µä½ã€‚';
                riskLevel = 'æ¥µä½é¢¨éšª';
            } else if (roi >= 200) {
                recommendation = 'å»ºè­°ç©æ¥µè©•ä¼°å°å…¥ã€‚æŠ•è³‡å ±é…¬ç‡è‰¯å¥½ï¼Œå…·æœ‰é¡¯è‘—æ•ˆç›Šã€‚';
                riskLevel = 'ä½é¢¨éšª';
            } else if (roi >= 100) {
                recommendation = 'å¯è€ƒæ…®å°å…¥ã€‚æŠ•è³‡å ±é…¬ç‡å°šå¯ï¼Œéœ€è©•ä¼°å…¶ä»–å› ç´ ã€‚';
                riskLevel = 'ä¸­ç­‰é¢¨éšª';
            } else {
                recommendation = 'å»ºè­°å¯©æ…è©•ä¼°ã€‚æŠ•è³‡å ±é…¬ç‡åä½ï¼Œéœ€æ·±å…¥åˆ†ææˆæœ¬æ•ˆç›Šã€‚';
                riskLevel = 'è¼ƒé«˜é¢¨éšª';
            }

            // å‰µå»ºPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // è¨­å®šä¸­æ–‡å­—é«”ï¼ˆä½¿ç”¨å…§å»ºå­—é«”ï¼‰
            doc.setFont('helvetica');
            
            // æ¨™é¡Œ
            doc.setFontSize(20);
            doc.text('55688å°ç£å¤§è»ŠéšŠä¼æ¥­æœƒå“¡ROIåˆ†æå ±å‘Š', 20, 30);
            
            // åŸºæœ¬è³‡è¨Š
            doc.setFontSize(14);
            doc.text('ä¼æ¥­åŸºæœ¬è³‡è¨Š', 20, 50);
            doc.setFontSize(12);
            doc.text(`å“¡å·¥äººæ•¸: ${employees}äºº`, 25, 65);
            doc.text(`æ¯æœˆä¹˜è»Šæ¬¡æ•¸: ${trips}æ¬¡`, 25, 75);
            doc.text(`å¹³å‡æ¯è¶Ÿè»Šè³‡: ${avgCost}`, 25, 85);
            
            // è²¡å‹™åˆ†æ
            doc.setFontSize(14);
            doc.text('è²¡å‹™æ•ˆç›Šåˆ†æ', 20, 105);
            doc.setFontSize(12);
            doc.text(`æ¯æœˆè»Šè³‡ç¸½é¡: ${monthlyTotal}`, 25, 120);
            doc.text(`ç®¡ç†æœå‹™è²»: ${serviceFee}`, 25, 130);
            doc.text(`æ¯æœˆæ·¨ç¯€çœ: ${monthlySaving}`, 25, 140);
            doc.text(`å¹´åº¦æ·¨ç¯€çœ: ${annualSaving}`, 25, 150);
            
            // ROIåˆ†æ
            doc.setFontSize(14);
            doc.text('æŠ•è³‡å ±é…¬ç‡åˆ†æ', 20, 170);
            doc.setFontSize(12);
            doc.text(`æœˆåº¦ROI: ${monthlyROI}`, 25, 185);
            doc.text(`å¹´åº¦ROI: ${annualROI}`, 25, 195);
            doc.text(`é¢¨éšªè©•ä¼°: ${riskLevel}`, 25, 205);
            
            // çµè«–å»ºè­°
            doc.setFontSize(14);
            doc.text('å°ˆæ¥­å»ºè­°', 20, 225);
            doc.setFontSize(12);
            
            // åˆ†è¡Œé¡¯ç¤ºå»ºè­°æ–‡å­—
            const recommendationLines = doc.splitTextToSize(recommendation, 160);
            let yPos = 240;
            recommendationLines.forEach(line => {
                doc.text(line, 25, yPos);
                yPos += 10;
            });
            
            // æ•ˆç›Šæ‘˜è¦
            doc.setFontSize(14);
            doc.text('æ•ˆç›Šæ‘˜è¦', 20, yPos + 10);
            doc.setFontSize(11);
            doc.text('âœ“ è‡ªå‹•åŒ–å¸³å‹™è™•ç†ï¼Œæ¸›å°‘äººåŠ›æˆæœ¬', 25, yPos + 25);
            doc.text('âœ“ æœˆçµä»˜æ¬¾æ–¹å¼ï¼Œæ”¹å–„ç¾é‡‘æµ', 25, yPos + 35);
            doc.text('âœ“ é›»å­å¸³å–®ç®¡ç†ï¼Œæå‡ä½œæ¥­æ•ˆç‡', 25, yPos + 45);
            doc.text('âœ“ å°ˆå±¬å®¢æœæ”¯æ´ï¼Œä¿éšœæœå‹™å“è³ª', 25, yPos + 55);
            
            // å ±å‘Šæ—¥æœŸ
            const today = new Date().toLocaleDateString('zh-TW');
            doc.setFontSize(10);
            doc.text(`å ±å‘Šç”Ÿæˆæ—¥æœŸ: ${today}`, 20, 280);
            doc.text('55688å°ç£å¤§è»ŠéšŠä¼æ¥­æœƒå“¡æœå‹™', 120, 280);
            
            // å„²å­˜PDF
            doc.save('55688ä¼æ¥­æœƒå“¡ROIåˆ†æå ±å‘Š.pdf');
            
            // é¡¯ç¤ºå®Œæˆè¨Šæ¯
            alert('PDFå ±å‘Šå·²æˆåŠŸç”Ÿæˆä¸¦ä¸‹è¼‰ï¼\n\n' + 
                  `æŠ•è³‡å»ºè­°: ${recommendation}\n` +
                  `æœˆåº¦ROI: ${monthlyROI}\n` +
                  `å¹´åº¦ç¯€çœ: ${annualSaving}`);
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            calculateROI();
        });
    </script>
</body>
</html>);
        }

        function calculateROI() {
            const employees = parseFloat(document.getElementById('employees').value) || 0;
            const trips = parseFloat(document.getElementById('trips').value) || 0;
            const avgCost = parseFloat(document.getElementById('avgCost').value) || 0;
            const adminTime = parseFloat(document.getElementById('adminTime').value) || 0;
            const hourlyRate = parseFloat(document.getElementById('hourlyRate').value) || 0;
            const creditLimit = parseFloat(document.getElementById('creditLimit').value) || 0;

            // è¨ˆç®—å„é …æˆæœ¬èˆ‡ç¯€çœï¼ˆç„¡ç®¡ç†æœå‹™è²»ï¼‰
            const monthlyTotal = trips * avgCost;
            const cashFlowBenefit = monthlyTotal * 0.02; // 2.0% å¹´åŒ–æ•ˆç›Š Ã· 12 (æœˆçµå»¶é²ä»˜æ¬¾30å¤©çš„è³‡é‡‘æ•ˆç›Š)
            const timeSaving = adminTime * hourlyRate;
            const receiptSaving = trips * 0.05 * 60; // 5% éºå¤±ç‡ï¼Œæ¯å¼µé‡é–‹60å…ƒ
            
            const monthlySaving = cashFlowBenefit + timeSaving + receiptSaving; // ç´”ç¯€çœï¼Œç„¡é¡å¤–æˆæœ¬
            const annualSaving = monthlySaving * 12;
            const annualTotal = monthlyTotal * 12;

            // é‡æ–°å®šç¾©æ•ˆç›ŠæŒ‡æ¨™ï¼ˆç„¡æœå‹™è²»æƒ…æ³ä¸‹ï¼‰
            const fareEfficiencyRatio = monthlyTotal > 0 ? (monthlySaving / monthlyTotal) * 100 : 0;
            const annualEfficiencyMultiple = annualTotal > 0 ? annualSaving / annualTotal : 0;
            const totalTraditionalCost = timeSaving + receiptSaving + monthlyTotal;
            const costReduction = totalTraditionalCost > 0 ? (monthlySaving / totalTraditionalCost) * 100 : 0;
            const efficiencyGain = adminTime > 0 ? ((timeSaving / (adminTime * hourlyRate)) * 100) : 0;

            // æ›´æ–°é¡¯ç¤º
            document.getElementById('monthlyTotal').textContent = formatNumber(monthlyTotal);
            document.getElementById('cashFlowBenefit').textContent = formatNumber(cashFlowBenefit);
            document.getElementById('timeSaving').textContent = formatNumber(timeSaving);
            document.getElementById('receiptSaving').textContent = formatNumber(receiptSaving);
            document.getElementById('monthlySaving').textContent = formatNumber(monthlySaving);
            document.getElementById('annualSaving').textContent = formatNumber(annualSaving);

            document.getElementById('fareEfficiencyRatio').textContent = Math.round(fareEfficiencyRatio) + '%';
            document.getElementById('annualEfficiencyMultiple').textContent = annualEfficiencyMultiple.toFixed(1) + 'å€';
            document.getElementById('costReduction').textContent = Math.round(costReduction) + '%';
            document.getElementById('efficiencyGain').textContent = Math.round(efficiencyGain) + '%';

            // æ›´æ–°æƒ…å¢ƒåˆ†æ
            updateScenarioAnalysis(avgCost, adminTime, hourlyRate);
            
            // æ›´æ–°åœ–è¡¨
            updateChart();
        }

        function updateScenarioAnalysis(avgCost, adminTime, hourlyRate) {
            const trips = parseFloat(document.getElementById('trips').value);
            
            const scenarios = [
                { trips: Math.round(trips * 0.6), name: 'conservative' },
                { trips: trips, name: 'normal' },
                { trips: Math.round(trips * 1.6), name: 'optimistic' }
            ];

            scenarios.forEach(scenario => {
                const monthlyTotal = scenario.trips * avgCost;
                const cashFlow = monthlyTotal * 0.02;
                const timeSave = adminTime * hourlyRate;
                const receiptSave = scenario.trips * 0.05 * 60;
                const monthlySave = cashFlow + timeSave + receiptSave; // ç´”ç¯€çœæ•ˆç›Š
                const annualSave = monthlySave * 12;
                const efficiencyRatio = monthlyTotal > 0 ? (monthlySave / monthlyTotal) * 100 : 0;

                document.getElementById(scenario.name + 'Saving').textContent = formatNumber(monthlySave);
                document.getElementById(scenario.name + 'ROI').textContent = Math.round(efficiencyRatio) + '%';
                document.getElementById(scenario.name + 'Annual').textContent = formatNumber(annualSave);

                // è¨­å®šæ•ˆç›Šæ¯”ç‡é¡è‰²
                const roiElement = document.getElementById(scenario.name + 'ROI');
                if (efficiencyRatio >= 20) {
                    roiElement.className = 'positive';
                } else if (efficiencyRatio >= 10) {
                    roiElement.className = 'warning';
                } else {
                    roiElement.className = 'negative';
                }
            });

            document.getElementById('normalTrips').textContent = trips + 'æ¬¡';
        }

        function updateChart() {
            const ctx = document.getElementById('roiChart').getContext('2d');
            
            // ç²å–ç•¶å‰æ•¸æ“š
            const trips = parseFloat(document.getElementById('trips').value);
            const avgCost = parseFloat(document.getElementById('avgCost').value);
            const adminTime = parseFloat(document.getElementById('adminTime').value);
            const hourlyRate = parseFloat(document.getElementById('hourlyRate').value);
            const serviceFeeRate = parseFloat(document.getElementById('serviceFeeRate').value);
            
            const scenarios = [
                { trips: Math.round(trips * 0.6), label: 'ä¿å®ˆä¼°è¨ˆ' },
                { trips: trips, label: 'ä¸€èˆ¬ç‹€æ³' },
                { trips: Math.round(trips * 1.6), label: 'æ¨‚è§€é æœŸ' }
            ];
            
            const data = scenarios.map(scenario => {
                const monthlyTotal = scenario.trips * avgCost;
                const serviceFee = monthlyTotal * (serviceFeeRate / 100);
                const cashFlow = monthlyTotal * 0.015;
                const timeSave = adminTime * hourlyRate;
                const receiptSave = scenario.trips * 0.05 * 60;
                const monthlySave = cashFlow + timeSave + receiptSave - serviceFee;
                return monthlySave;
            });

            if (roiChart) {
                roiChart.destroy();
            }

            roiChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: scenarios.map(s => s.label),
                    datasets: [{
                        label: 'æ¯æœˆæ·¨ç¯€çœé‡‘é¡ (å…ƒ)',
                        data: data,
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(168, 85, 247, 0.8)'
                        ],
                        borderColor: [
                            'rgb(59, 130, 246)',
                            'rgb(34, 197, 94)',
                            'rgb(168, 85, 247)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ä¸åŒæƒ…å¢ƒä¸‹çš„æœˆåº¦ç¯€çœæ•ˆç›Šæ¯”è¼ƒ',
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return ' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        function recalculate() {
            document.querySelector('.results-section').classList.add('highlight-animation');
            setTimeout(() => {
                document.querySelector('.results-section').classList.remove('highlight-animation');
            }, 800);
            
            calculateROI();
        }

        function resetDefaults() {
            const defaults = {
                'employees': 100,
                'trips': 50,
                'avgCost': 300,
                'adminTime': 15,
                'hourlyRate': 200,
                'serviceFeeRate': 3
            };

            Object.keys(defaults).forEach(id => {
                document.getElementById(id).value = defaults[id];
            });

            calculateROI();
            alert('æ•¸æ“šå·²é‡è¨­ç‚ºé è¨­å€¼ï¼');
        }

        function generatePDFReport() {
            // ç²å–ç•¶å‰æ•¸æ“š
            const employees = document.getElementById('employees').value;
            const trips = document.getElementById('trips').value;
            const avgCost = document.getElementById('avgCost').value;
            const monthlyTotal = document.getElementById('monthlyTotal').textContent;
            const serviceFee = document.getElementById('serviceFee').textContent;
            const monthlySaving = document.getElementById('monthlySaving').textContent;
            const annualSaving = document.getElementById('annualSaving').textContent;
            const monthlyROI = document.getElementById('monthlyROI').textContent;
            const annualROI = document.getElementById('annualROI').textContent;
            
            // è©•ä¼°å»ºè­°
            const roi = parseFloat(monthlyROI);
            let recommendation = '';
            let riskLevel = '';
            
            if (roi >= 500) {
                recommendation = 'å¼·çƒˆå»ºè­°ç«‹å³å°å…¥ï¼æŠ•è³‡å ±é…¬ç‡æ¥µä½³ï¼Œé¢¨éšªæ¥µä½ã€‚';
                riskLevel = 'æ¥µä½é¢¨éšª';
            } else if (roi >= 200) {
                recommendation = 'å»ºè­°ç©æ¥µè©•ä¼°å°å…¥ã€‚æŠ•è³‡å ±é…¬ç‡è‰¯å¥½ï¼Œå…·æœ‰é¡¯è‘—æ•ˆç›Šã€‚';
                riskLevel = 'ä½é¢¨éšª';
            } else if (roi >= 100) {
                recommendation = 'å¯è€ƒæ…®å°å…¥ã€‚æŠ•è³‡å ±é…¬ç‡å°šå¯ï¼Œéœ€è©•ä¼°å…¶ä»–å› ç´ ã€‚';
                riskLevel = 'ä¸­ç­‰é¢¨éšª';
            } else {
                recommendation = 'å»ºè­°å¯©æ…è©•ä¼°ã€‚æŠ•è³‡å ±é…¬ç‡åä½ï¼Œéœ€æ·±å…¥åˆ†ææˆæœ¬æ•ˆç›Šã€‚';
                riskLevel = 'è¼ƒé«˜é¢¨éšª';
            }

            // å‰µå»ºPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // è¨­å®šä¸­æ–‡å­—é«”ï¼ˆä½¿ç”¨å…§å»ºå­—é«”ï¼‰
            doc.setFont('helvetica');
            
            // æ¨™é¡Œ
            doc.setFontSize(20);
            doc.text('55688å°ç£å¤§è»ŠéšŠä¼æ¥­æœƒå“¡ROIåˆ†æå ±å‘Š', 20, 30);
            
            // åŸºæœ¬è³‡è¨Š
            doc.setFontSize(14);
            doc.text('ä¼æ¥­åŸºæœ¬è³‡è¨Š', 20, 50);
            doc.setFontSize(12);
            doc.text(`å“¡å·¥äººæ•¸: ${employees}äºº`, 25, 65);
            doc.text(`æ¯æœˆä¹˜è»Šæ¬¡æ•¸: ${trips}æ¬¡`, 25, 75);
            doc.text(`å¹³å‡æ¯è¶Ÿè»Šè³‡: ${avgCost}`, 25, 85);
            
            // è²¡å‹™åˆ†æ
            doc.setFontSize(14);
            doc.text('è²¡å‹™æ•ˆç›Šåˆ†æ', 20, 105);
            doc.setFontSize(12);
            doc.text(`æ¯æœˆè»Šè³‡ç¸½é¡: ${monthlyTotal}`, 25, 120);
            doc.text(`ç®¡ç†æœå‹™è²»: ${serviceFee}`, 25, 130);
            doc.text(`æ¯æœˆæ·¨ç¯€çœ: ${monthlySaving}`, 25, 140);
            doc.text(`å¹´åº¦æ·¨ç¯€çœ: ${annualSaving}`, 25, 150);
            
            // ROIåˆ†æ
            doc.setFontSize(14);
            doc.text('æŠ•è³‡å ±é…¬ç‡åˆ†æ', 20, 170);
            doc.setFontSize(12);
            doc.text(`æœˆåº¦ROI: ${monthlyROI}`, 25, 185);
            doc.text(`å¹´åº¦ROI: ${annualROI}`, 25, 195);
            doc.text(`é¢¨éšªè©•ä¼°: ${riskLevel}`, 25, 205);
            
            // çµè«–å»ºè­°
            doc.setFontSize(14);
            doc.text('å°ˆæ¥­å»ºè­°', 20, 225);
            doc.setFontSize(12);
            
            // åˆ†è¡Œé¡¯ç¤ºå»ºè­°æ–‡å­—
            const recommendationLines = doc.splitTextToSize(recommendation, 160);
            let yPos = 240;
            recommendationLines.forEach(line => {
                doc.text(line, 25, yPos);
                yPos += 10;
            });
            
            // æ•ˆç›Šæ‘˜è¦
            doc.setFontSize(14);
            doc.text('æ•ˆç›Šæ‘˜è¦', 20, yPos + 10);
            doc.setFontSize(11);
            doc.text('âœ“ è‡ªå‹•åŒ–å¸³å‹™è™•ç†ï¼Œæ¸›å°‘äººåŠ›æˆæœ¬', 25, yPos + 25);
            doc.text('âœ“ æœˆçµä»˜æ¬¾æ–¹å¼ï¼Œæ”¹å–„ç¾é‡‘æµ', 25, yPos + 35);
            doc.text('âœ“ é›»å­å¸³å–®ç®¡ç†ï¼Œæå‡ä½œæ¥­æ•ˆç‡', 25, yPos + 45);
            doc.text('âœ“ å°ˆå±¬å®¢æœæ”¯æ´ï¼Œä¿éšœæœå‹™å“è³ª', 25, yPos + 55);
            
            // å ±å‘Šæ—¥æœŸ
            const today = new Date().toLocaleDateString('zh-TW');
            doc.setFontSize(10);
            doc.text(`å ±å‘Šç”Ÿæˆæ—¥æœŸ: ${today}`, 20, 280);
            doc.text('55688å°ç£å¤§è»ŠéšŠä¼æ¥­æœƒå“¡æœå‹™', 120, 280);
            
            // å„²å­˜PDF
            doc.save('55688ä¼æ¥­æœƒå“¡ROIåˆ†æå ±å‘Š.pdf');
            
            // é¡¯ç¤ºå®Œæˆè¨Šæ¯
            alert('PDFå ±å‘Šå·²æˆåŠŸç”Ÿæˆä¸¦ä¸‹è¼‰ï¼\n\n' + 
                  `æŠ•è³‡å»ºè­°: ${recommendation}\n` +
                  `æœˆåº¦ROI: ${monthlyROI}\n` +
                  `å¹´åº¦ç¯€çœ: ${annualSaving}`);
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            calculateROI();
        });
    </script>
</body>
</html> + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }document.getElementById('hourlyRate').value);
            const serviceFeeRate = parseFloat(document.getElementById('serviceFeeRate').value);
            
            const scenarios = [
                { trips: Math.round(trips * 0.6), label: 'ä¿å®ˆä¼°è¨ˆ' },
                { trips: trips, label: 'ä¸€èˆ¬ç‹€æ³' },
                { trips: Math.round(trips * 1.6), label: 'æ¨‚è§€é æœŸ' }
            ];
            
            const data = scenarios.map(scenario => {
                const monthlyTotal = scenario.trips * avgCost;
                const serviceFee = monthlyTotal * (serviceFeeRate / 100);
                const cashFlow = monthlyTotal * 0.015;
                const timeSave = adminTime * hourlyRate;
                const receiptSave = scenario.trips * 0.05 * 60;
                const monthlySave = cashFlow + timeSave + receiptSave - serviceFee;
                return monthlySave;
            });

            if (roiChart) {
                roiChart.destroy();
            }

            roiChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: scenarios.map(s => s.label),
                    datasets: [{
                        label: 'æ¯æœˆæ·¨ç¯€çœé‡‘é¡ (å…ƒ)',
                        data: data,
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(168, 85, 247, 0.8)'
                        ],
                        borderColor: [
                            'rgb(59, 130, 246)',
                            'rgb(34, 197, 94)',
                            'rgb(168, 85, 247)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ä¸åŒæƒ…å¢ƒä¸‹çš„æœˆåº¦ç¯€çœæ•ˆç›Šæ¯”è¼ƒ',
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return ' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        function recalculate() {
            document.querySelector('.results-section').classList.add('highlight-animation');
            setTimeout(() => {
                document.querySelector('.results-section').classList.remove('highlight-animation');
            }, 800);
            
            calculateROI();
        }

        function resetDefaults() {
            const defaults = {
                'employees': 100,
                'trips': 50,
                'avgCost': 300,
                'adminTime': 15,
                'hourlyRate': 200,
                'serviceFeeRate': 3
            };

            Object.keys(defaults).forEach(id => {
                document.getElementById(id).value = defaults[id];
            });

            calculateROI();
            alert('æ•¸æ“šå·²é‡è¨­ç‚ºé è¨­å€¼ï¼');
        }

        function generatePDFReport() {
            // ç²å–ç•¶å‰æ•¸æ“š
            const employees = document.getElementById('employees').value;
            const trips = document.getElementById('trips').value;
            const avgCost = document.getElementById('avgCost').value;
            const monthlyTotal = document.getElementById('monthlyTotal').textContent;
            const serviceFee = document.getElementById('serviceFee').textContent;
            const monthlySaving = document.getElementById('monthlySaving').textContent;
            const annualSaving = document.getElementById('annualSaving').textContent;
            const monthlyROI = document.getElementById('monthlyROI').textContent;
            const annualROI = document.getElementById('annualROI').textContent;
            
            // è©•ä¼°å»ºè­°
            const roi = parseFloat(monthlyROI);
            let recommendation = '';
            let riskLevel = '';
            
            if (roi >= 500) {
                recommendation = 'å¼·çƒˆå»ºè­°ç«‹å³å°å…¥ï¼æŠ•è³‡å ±é…¬ç‡æ¥µä½³ï¼Œé¢¨éšªæ¥µä½ã€‚';
                riskLevel = 'æ¥µä½é¢¨éšª';
            } else if (roi >= 200) {
                recommendation = 'å»ºè­°ç©æ¥µè©•ä¼°å°å…¥ã€‚æŠ•è³‡å ±é…¬ç‡è‰¯å¥½ï¼Œå…·æœ‰é¡¯è‘—æ•ˆç›Šã€‚';
                riskLevel = 'ä½é¢¨éšª';
            } else if (roi >= 100) {
                recommendation = 'å¯è€ƒæ…®å°å…¥ã€‚æŠ•è³‡å ±é…¬ç‡å°šå¯ï¼Œéœ€è©•ä¼°å…¶ä»–å› ç´ ã€‚';
                riskLevel = 'ä¸­ç­‰é¢¨éšª';
            } else {
                recommendation = 'å»ºè­°å¯©æ…è©•ä¼°ã€‚æŠ•è³‡å ±é…¬ç‡åä½ï¼Œéœ€æ·±å…¥åˆ†ææˆæœ¬æ•ˆç›Šã€‚';
                riskLevel = 'è¼ƒé«˜é¢¨éšª';
            }

            // å‰µå»ºPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // è¨­å®šä¸­æ–‡å­—é«”ï¼ˆä½¿ç”¨å…§å»ºå­—é«”ï¼‰
            doc.setFont('helvetica');
            
            // æ¨™é¡Œ
            doc.setFontSize(20);
            doc.text('55688å°ç£å¤§è»ŠéšŠä¼æ¥­æœƒå“¡ROIåˆ†æå ±å‘Š', 20, 30);
            
            // åŸºæœ¬è³‡è¨Š
            doc.setFontSize(14);
            doc.text('ä¼æ¥­åŸºæœ¬è³‡è¨Š', 20, 50);
            doc.setFontSize(12);
            doc.text(`å“¡å·¥äººæ•¸: ${employees}äºº`, 25, 65);
            doc.text(`æ¯æœˆä¹˜è»Šæ¬¡æ•¸: ${trips}æ¬¡`, 25, 75);
            doc.text(`å¹³å‡æ¯è¶Ÿè»Šè³‡: ${avgCost}`, 25, 85);
            
            // è²¡å‹™åˆ†æ
            doc.setFontSize(14);
            doc.text('è²¡å‹™æ•ˆç›Šåˆ†æ', 20, 105);
            doc.setFontSize(12);
            doc.text(`æ¯æœˆè»Šè³‡ç¸½é¡: ${monthlyTotal}`, 25, 120);
            doc.text(`ç®¡ç†æœå‹™è²»: ${serviceFee}`, 25, 130);
            doc.text(`æ¯æœˆæ·¨ç¯€çœ: ${monthlySaving}`, 25, 140);
            doc.text(`å¹´åº¦æ·¨ç¯€çœ: ${annualSaving}`, 25, 150);
            
            // ROIåˆ†æ
            doc.setFontSize(14);
            doc.text('æŠ•è³‡å ±é…¬ç‡åˆ†æ', 20, 170);
            doc.setFontSize(12);
            doc.text(`æœˆåº¦ROI: ${monthlyROI}`, 25, 185);
            doc.text(`å¹´åº¦ROI: ${annualROI}`, 25, 195);
            doc.text(`é¢¨éšªè©•ä¼°: ${riskLevel}`, 25, 205);
            
            // çµè«–å»ºè­°
            doc.setFontSize(14);
            doc.text('å°ˆæ¥­å»ºè­°', 20, 225);
            doc.setFontSize(12);
            
            // åˆ†è¡Œé¡¯ç¤ºå»ºè­°æ–‡å­—
            const recommendationLines = doc.splitTextToSize(recommendation, 160);
            let yPos = 240;
            recommendationLines.forEach(line => {
                doc.text(line, 25, yPos);
                yPos += 10;
            });
            
            // æ•ˆç›Šæ‘˜è¦
            doc.setFontSize(14);
            doc.text('æ•ˆç›Šæ‘˜è¦', 20, yPos + 10);
            doc.setFontSize(11);
            doc.text('âœ“ è‡ªå‹•åŒ–å¸³å‹™è™•ç†ï¼Œæ¸›å°‘äººåŠ›æˆæœ¬', 25, yPos + 25);
            doc.text('âœ“ æœˆçµä»˜æ¬¾æ–¹å¼ï¼Œæ”¹å–„ç¾é‡‘æµ', 25, yPos + 35);
            doc.text('âœ“ é›»å­å¸³å–®ç®¡ç†ï¼Œæå‡ä½œæ¥­æ•ˆç‡', 25, yPos + 45);
            doc.text('âœ“ å°ˆå±¬å®¢æœæ”¯æ´ï¼Œä¿éšœæœå‹™å“è³ª', 25, yPos + 55);
            
            // å ±å‘Šæ—¥æœŸ
            const today = new Date().toLocaleDateString('zh-TW');
            doc.setFontSize(10);
            doc.text(`å ±å‘Šç”Ÿæˆæ—¥æœŸ: ${today}`, 20, 280);
            doc.text('55688å°ç£å¤§è»ŠéšŠä¼æ¥­æœƒå“¡æœå‹™', 120, 280);
            
            // å„²å­˜PDF
            doc.save('55688ä¼æ¥­æœƒå“¡ROIåˆ†æå ±å‘Š.pdf');
            
            // é¡¯ç¤ºå®Œæˆè¨Šæ¯
            alert('PDFå ±å‘Šå·²æˆåŠŸç”Ÿæˆä¸¦ä¸‹è¼‰ï¼\n\n' + 
                  `æŠ•è³‡å»ºè­°: ${recommendation}\n` +
                  `æœˆåº¦ROI: ${monthlyROI}\n` +
                  `å¹´åº¦ç¯€çœ: ${annualSaving}`);
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            calculateROI();
        });
    </script>
</body>
</html>, '

        function updateChart() {
            const ctx = document.getElementById('roiChart').getContext('2d');
            
            // ç²å–ç•¶å‰æ•¸æ“š
            const trips = parseFloat(document.getElementById('trips').value);
            const avgCost = parseFloat(document.getElementById('avgCost').value);
            const adminTime = parseFloat(document.getElementById('adminTime').value);
            const hourlyRate = parseFloat(document.getElementById('hourlyRate').value);
            const serviceFeeRate = parseFloat(document.getElementById('serviceFeeRate').value);
            
            const scenarios = [
                { trips: Math.round(trips * 0.6), label: 'ä¿å®ˆä¼°è¨ˆ' },
                { trips: trips, label: 'ä¸€èˆ¬ç‹€æ³' },
                { trips: Math.round(trips * 1.6), label: 'æ¨‚è§€é æœŸ' }
            ];
            
            const data = scenarios.map(scenario => {
                const monthlyTotal = scenario.trips * avgCost;
                const serviceFee = monthlyTotal * (serviceFeeRate / 100);
                const cashFlow = monthlyTotal * 0.015;
                const timeSave = adminTime * hourlyRate;
                const receiptSave = scenario.trips * 0.05 * 60;
                const monthlySave = cashFlow + timeSave + receiptSave - serviceFee;
                return monthlySave;
            });

            if (roiChart) {
                roiChart.destroy();
            }

            roiChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: scenarios.map(s => s.label),
                    datasets: [{
                        label: 'æ¯æœˆæ·¨ç¯€çœé‡‘é¡ (å…ƒ)',
                        data: data,
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(168, 85, 247, 0.8)'
                        ],
                        borderColor: [
                            'rgb(59, 130, 246)',
                            'rgb(34, 197, 94)',
                            'rgb(168, 85, 247)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ä¸åŒæƒ…å¢ƒä¸‹çš„æœˆåº¦ç¯€çœæ•ˆç›Šæ¯”è¼ƒ',
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return ' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        function recalculate() {
            document.querySelector('.results-section').classList.add('highlight-animation');
            setTimeout(() => {
                document.querySelector('.results-section').classList.remove('highlight-animation');
            }, 800);
            
            calculateROI();
        }

        function resetDefaults() {
            const defaults = {
                'employees': 100,
                'trips': 50,
                'avgCost': 300,
                'adminTime': 15,
                'hourlyRate': 200,
                'serviceFeeRate': 3
            };

            Object.keys(defaults).forEach(id => {
                document.getElementById(id).value = defaults[id];
            });

            calculateROI();
            alert('æ•¸æ“šå·²é‡è¨­ç‚ºé è¨­å€¼ï¼');
        }

        function generatePDFReport() {
            // ç²å–ç•¶å‰æ•¸æ“š
            const employees = document.getElementById('employees').value;
            const trips = document.getElementById('trips').value;
            const avgCost = document.getElementById('avgCost').value;
            const monthlyTotal = document.getElementById('monthlyTotal').textContent;
            const serviceFee = document.getElementById('serviceFee').textContent;
            const monthlySaving = document.getElementById('monthlySaving').textContent;
            const annualSaving = document.getElementById('annualSaving').textContent;
            const monthlyROI = document.getElementById('monthlyROI').textContent;
            const annualROI = document.getElementById('annualROI').textContent;
            
            // è©•ä¼°å»ºè­°
            const roi = parseFloat(monthlyROI);
            let recommendation = '';
            let riskLevel = '';
            
            if (roi >= 500) {
                recommendation = 'å¼·çƒˆå»ºè­°ç«‹å³å°å…¥ï¼æŠ•è³‡å ±é…¬ç‡æ¥µä½³ï¼Œé¢¨éšªæ¥µä½ã€‚';
                riskLevel = 'æ¥µä½é¢¨éšª';
            } else if (roi >= 200) {
                recommendation = 'å»ºè­°ç©æ¥µè©•ä¼°å°å…¥ã€‚æŠ•è³‡å ±é…¬ç‡è‰¯å¥½ï¼Œå…·æœ‰é¡¯è‘—æ•ˆç›Šã€‚';
                riskLevel = 'ä½é¢¨éšª';
            } else if (roi >= 100) {
                recommendation = 'å¯è€ƒæ…®å°å…¥ã€‚æŠ•è³‡å ±é…¬ç‡å°šå¯ï¼Œéœ€è©•ä¼°å…¶ä»–å› ç´ ã€‚';
                riskLevel = 'ä¸­ç­‰é¢¨éšª';
            } else {
                recommendation = 'å»ºè­°å¯©æ…è©•ä¼°ã€‚æŠ•è³‡å ±é…¬ç‡åä½ï¼Œéœ€æ·±å…¥åˆ†ææˆæœ¬æ•ˆç›Šã€‚';
                riskLevel = 'è¼ƒé«˜é¢¨éšª';
            }

            // å‰µå»ºPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // è¨­å®šä¸­æ–‡å­—é«”ï¼ˆä½¿ç”¨å…§å»ºå­—é«”ï¼‰
            doc.setFont('helvetica');
            
            // æ¨™é¡Œ
            doc.setFontSize(20);
            doc.text('55688å°ç£å¤§è»ŠéšŠä¼æ¥­æœƒå“¡ROIåˆ†æå ±å‘Š', 20, 30);
            
            // åŸºæœ¬è³‡è¨Š
            doc.setFontSize(14);
            doc.text('ä¼æ¥­åŸºæœ¬è³‡è¨Š', 20, 50);
            doc.setFontSize(12);
            doc.text(`å“¡å·¥äººæ•¸: ${employees}äºº`, 25, 65);
            doc.text(`æ¯æœˆä¹˜è»Šæ¬¡æ•¸: ${trips}æ¬¡`, 25, 75);
            doc.text(`å¹³å‡æ¯è¶Ÿè»Šè³‡: ${avgCost}`, 25, 85);
            
            // è²¡å‹™åˆ†æ
            doc.setFontSize(14);
            doc.text('è²¡å‹™æ•ˆç›Šåˆ†æ', 20, 105);
            doc.setFontSize(12);
            doc.text(`æ¯æœˆè»Šè³‡ç¸½é¡: ${monthlyTotal}`, 25, 120);
            doc.text(`ç®¡ç†æœå‹™è²»: ${serviceFee}`, 25, 130);
            doc.text(`æ¯æœˆæ·¨ç¯€çœ: ${monthlySaving}`, 25, 140);
            doc.text(`å¹´åº¦æ·¨ç¯€çœ: ${annualSaving}`, 25, 150);
            
            // ROIåˆ†æ
            doc.setFontSize(14);
            doc.text('æŠ•è³‡å ±é…¬ç‡åˆ†æ', 20, 170);
            doc.setFontSize(12);
            doc.text(`æœˆåº¦ROI: ${monthlyROI}`, 25, 185);
            doc.text(`å¹´åº¦ROI: ${annualROI}`, 25, 195);
            doc.text(`é¢¨éšªè©•ä¼°: ${riskLevel}`, 25, 205);
            
            // çµè«–å»ºè­°
            doc.setFontSize(14);
            doc.text('å°ˆæ¥­å»ºè­°', 20, 225);
            doc.setFontSize(12);
            
            // åˆ†è¡Œé¡¯ç¤ºå»ºè­°æ–‡å­—
            const recommendationLines = doc.splitTextToSize(recommendation, 160);
            let yPos = 240;
            recommendationLines.forEach(line => {
                doc.text(line, 25, yPos);
                yPos += 10;
            });
            
            // æ•ˆç›Šæ‘˜è¦
            doc.setFontSize(14);
            doc.text('æ•ˆç›Šæ‘˜è¦', 20, yPos + 10);
            doc.setFontSize(11);
            doc.text('âœ“ è‡ªå‹•åŒ–å¸³å‹™è™•ç†ï¼Œæ¸›å°‘äººåŠ›æˆæœ¬', 25, yPos + 25);
            doc.text('âœ“ æœˆçµä»˜æ¬¾æ–¹å¼ï¼Œæ”¹å–„ç¾é‡‘æµ', 25, yPos + 35);
            doc.text('âœ“ é›»å­å¸³å–®ç®¡ç†ï¼Œæå‡ä½œæ¥­æ•ˆç‡', 25, yPos + 45);
            doc.text('âœ“ å°ˆå±¬å®¢æœæ”¯æ´ï¼Œä¿éšœæœå‹™å“è³ª', 25, yPos + 55);
            
            // å ±å‘Šæ—¥æœŸ
            const today = new Date().toLocaleDateString('zh-TW');
            doc.setFontSize(10);
            doc.text(`å ±å‘Šç”Ÿæˆæ—¥æœŸ: ${today}`, 20, 280);
            doc.text('55688å°ç£å¤§è»ŠéšŠä¼æ¥­æœƒå“¡æœå‹™', 120, 280);
            
            // å„²å­˜PDF
            doc.save('55688ä¼æ¥­æœƒå“¡ROIåˆ†æå ±å‘Š.pdf');
            
            // é¡¯ç¤ºå®Œæˆè¨Šæ¯
            alert('PDFå ±å‘Šå·²æˆåŠŸç”Ÿæˆä¸¦ä¸‹è¼‰ï¼\n\n' + 
                  `æŠ•è³‡å»ºè­°: ${recommendation}\n` +
                  `æœˆåº¦ROI: ${monthlyROI}\n` +
                  `å¹´åº¦ç¯€çœ: ${annualSaving}`);
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            calculateROI();
        });
    </script>
</body>
</html>);
        }

        function calculateROI() {
            const employees = parseFloat(document.getElementById('employees').value) || 0;
            const trips = parseFloat(document.getElementById('trips').value) || 0;
            const avgCost = parseFloat(document.getElementById('avgCost').value) || 0;
            const adminTime = parseFloat(document.getElementById('adminTime').value) || 0;
            const hourlyRate = parseFloat(document.getElementById('hourlyRate').value) || 0;
            const creditLimit = parseFloat(document.getElementById('creditLimit').value) || 0;

            // è¨ˆç®—å„é …æˆæœ¬èˆ‡ç¯€çœï¼ˆç„¡ç®¡ç†æœå‹™è²»ï¼‰
            const monthlyTotal = trips * avgCost;
            const cashFlowBenefit = monthlyTotal * 0.02; // 2.0% å¹´åŒ–æ•ˆç›Š Ã· 12 (æœˆçµå»¶é²ä»˜æ¬¾30å¤©çš„è³‡é‡‘æ•ˆç›Š)
            const timeSaving = adminTime * hourlyRate;
            const receiptSaving = trips * 0.05 * 60; // 5% éºå¤±ç‡ï¼Œæ¯å¼µé‡é–‹60å…ƒ
            
            const monthlySaving = cashFlowBenefit + timeSaving + receiptSaving; // ç´”ç¯€çœï¼Œç„¡é¡å¤–æˆæœ¬
            const annualSaving = monthlySaving * 12;
            const annualTotal = monthlyTotal * 12;

            // é‡æ–°å®šç¾©æ•ˆç›ŠæŒ‡æ¨™ï¼ˆç„¡æœå‹™è²»æƒ…æ³ä¸‹ï¼‰
            const fareEfficiencyRatio = monthlyTotal > 0 ? (monthlySaving / monthlyTotal) * 100 : 0;
            const annualEfficiencyMultiple = annualTotal > 0 ? annualSaving / annualTotal : 0;
            const totalTraditionalCost = timeSaving + receiptSaving + monthlyTotal;
            const costReduction = totalTraditionalCost > 0 ? (monthlySaving / totalTraditionalCost) * 100 : 0;
            const efficiencyGain = adminTime > 0 ? ((timeSaving / (adminTime * hourlyRate)) * 100) : 0;

            // æ›´æ–°é¡¯ç¤º
            document.getElementById('monthlyTotal').textContent = formatNumber(monthlyTotal);
            document.getElementById('cashFlowBenefit').textContent = formatNumber(cashFlowBenefit);
            document.getElementById('timeSaving').textContent = formatNumber(timeSaving);
            document.getElementById('receiptSaving').textContent = formatNumber(receiptSaving);
            document.getElementById('monthlySaving').textContent = formatNumber(monthlySaving);
            document.getElementById('annualSaving').textContent = formatNumber(annualSaving);

            document.getElementById('fareEfficiencyRatio').textContent = Math.round(fareEfficiencyRatio) + '%';
            document.getElementById('annualEfficiencyMultiple').textContent = annualEfficiencyMultiple.toFixed(1) + 'å€';
            document.getElementById('costReduction').textContent = Math.round(costReduction) + '%';
            document.getElementById('efficiencyGain').textContent = Math.round(efficiencyGain) + '%';

            // æ›´æ–°æƒ…å¢ƒåˆ†æ
            updateScenarioAnalysis(avgCost, adminTime, hourlyRate);
            
            // æ›´æ–°åœ–è¡¨
            updateChart();
        }

        function updateScenarioAnalysis(avgCost, adminTime, hourlyRate) {
            const trips = parseFloat(document.getElementById('trips').value);
            
            const scenarios = [
                { trips: Math.round(trips * 0.6), name: 'conservative' },
                { trips: trips, name: 'normal' },
                { trips: Math.round(trips * 1.6), name: 'optimistic' }
            ];

            scenarios.forEach(scenario => {
                const monthlyTotal = scenario.trips * avgCost;
                const cashFlow = monthlyTotal * 0.02;
                const timeSave = adminTime * hourlyRate;
                const receiptSave = scenario.trips * 0.05 * 60;
                const monthlySave = cashFlow + timeSave + receiptSave; // ç´”ç¯€çœæ•ˆç›Š
                const annualSave = monthlySave * 12;
                const efficiencyRatio = monthlyTotal > 0 ? (monthlySave / monthlyTotal) * 100 : 0;

                document.getElementById(scenario.name + 'Saving').textContent = formatNumber(monthlySave);
                document.getElementById(scenario.name + 'ROI').textContent = Math.round(efficiencyRatio) + '%';
                document.getElementById(scenario.name + 'Annual').textContent = formatNumber(annualSave);

                // è¨­å®šæ•ˆç›Šæ¯”ç‡é¡è‰²
                const roiElement = document.getElementById(scenario.name + 'ROI');
                if (efficiencyRatio >= 20) {
                    roiElement.className = 'positive';
                } else if (efficiencyRatio >= 10) {
                    roiElement.className = 'warning';
                } else {
                    roiElement.className = 'negative';
                }
            });

            document.getElementById('normalTrips').textContent = trips + 'æ¬¡';
        }

        function updateChart() {
            const ctx = document.getElementById('roiChart').getContext('2d');
            
            // ç²å–ç•¶å‰æ•¸æ“š
            const trips = parseFloat(document.getElementById('trips').value);
            const avgCost = parseFloat(document.getElementById('avgCost').value);
            const adminTime = parseFloat(document.getElementById('adminTime').value);
            const hourlyRate = parseFloat(document.getElementById('hourlyRate').value);
            const serviceFeeRate = parseFloat(document.getElementById('serviceFeeRate').value);
            
            const scenarios = [
                { trips: Math.round(trips * 0.6), label: 'ä¿å®ˆä¼°è¨ˆ' },
                { trips: trips, label: 'ä¸€èˆ¬ç‹€æ³' },
                { trips: Math.round(trips * 1.6), label: 'æ¨‚è§€é æœŸ' }
            ];
            
            const data = scenarios.map(scenario => {
                const monthlyTotal = scenario.trips * avgCost;
                const serviceFee = monthlyTotal * (serviceFeeRate / 100);
                const cashFlow = monthlyTotal * 0.015;
                const timeSave = adminTime * hourlyRate;
                const receiptSave = scenario.trips * 0.05 * 60;
                const monthlySave = cashFlow + timeSave + receiptSave - serviceFee;
                return monthlySave;
            });

            if (roiChart) {
                roiChart.destroy();
            }

            roiChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: scenarios.map(s => s.label),
                    datasets: [{
                        label: 'æ¯æœˆæ·¨ç¯€çœé‡‘é¡ (å…ƒ)',
                        data: data,
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(168, 85, 247, 0.8)'
                        ],
                        borderColor: [
                            'rgb(59, 130, 246)',
                            'rgb(34, 197, 94)',
                            'rgb(168, 85, 247)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'ä¸åŒæƒ…å¢ƒä¸‹çš„æœˆåº¦ç¯€çœæ•ˆç›Šæ¯”è¼ƒ',
                            font: {
                                size: 16,
                                weight: 'bold'
                            }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return ' + value.toLocaleString();
                                }
                            }
                        }
                    }
                }
            });
        }

        function recalculate() {
            document.querySelector('.results-section').classList.add('highlight-animation');
            setTimeout(() => {
                document.querySelector('.results-section').classList.remove('highlight-animation');
            }, 800);
            
            calculateROI();
        }

        function resetDefaults() {
            const defaults = {
                'employees': 100,
                'trips': 50,
                'avgCost': 300,
                'adminTime': 15,
                'hourlyRate': 200,
                'serviceFeeRate': 3
            };

            Object.keys(defaults).forEach(id => {
                document.getElementById(id).value = defaults[id];
            });

            calculateROI();
            alert('æ•¸æ“šå·²é‡è¨­ç‚ºé è¨­å€¼ï¼');
        }

        function generatePDFReport() {
            // ç²å–ç•¶å‰æ•¸æ“š
            const employees = document.getElementById('employees').value;
            const trips = document.getElementById('trips').value;
            const avgCost = document.getElementById('avgCost').value;
            const monthlyTotal = document.getElementById('monthlyTotal').textContent;
            const serviceFee = document.getElementById('serviceFee').textContent;
            const monthlySaving = document.getElementById('monthlySaving').textContent;
            const annualSaving = document.getElementById('annualSaving').textContent;
            const monthlyROI = document.getElementById('monthlyROI').textContent;
            const annualROI = document.getElementById('annualROI').textContent;
            
            // è©•ä¼°å»ºè­°
            const roi = parseFloat(monthlyROI);
            let recommendation = '';
            let riskLevel = '';
            
            if (roi >= 500) {
                recommendation = 'å¼·çƒˆå»ºè­°ç«‹å³å°å…¥ï¼æŠ•è³‡å ±é…¬ç‡æ¥µä½³ï¼Œé¢¨éšªæ¥µä½ã€‚';
                riskLevel = 'æ¥µä½é¢¨éšª';
            } else if (roi >= 200) {
                recommendation = 'å»ºè­°ç©æ¥µè©•ä¼°å°å…¥ã€‚æŠ•è³‡å ±é…¬ç‡è‰¯å¥½ï¼Œå…·æœ‰é¡¯è‘—æ•ˆç›Šã€‚';
                riskLevel = 'ä½é¢¨éšª';
            } else if (roi >= 100) {
                recommendation = 'å¯è€ƒæ…®å°å…¥ã€‚æŠ•è³‡å ±é…¬ç‡å°šå¯ï¼Œéœ€è©•ä¼°å…¶ä»–å› ç´ ã€‚';
                riskLevel = 'ä¸­ç­‰é¢¨éšª';
            } else {
                recommendation = 'å»ºè­°å¯©æ…è©•ä¼°ã€‚æŠ•è³‡å ±é…¬ç‡åä½ï¼Œéœ€æ·±å…¥åˆ†ææˆæœ¬æ•ˆç›Šã€‚';
                riskLevel = 'è¼ƒé«˜é¢¨éšª';
            }

            // å‰µå»ºPDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // è¨­å®šä¸­æ–‡å­—é«”ï¼ˆä½¿ç”¨å…§å»ºå­—é«”ï¼‰
            doc.setFont('helvetica');
            
            // æ¨™é¡Œ
            doc.setFontSize(20);
            doc.text('55688å°ç£å¤§è»ŠéšŠä¼æ¥­æœƒå“¡ROIåˆ†æå ±å‘Š', 20, 30);
            
            // åŸºæœ¬è³‡è¨Š
            doc.setFontSize(14);
            doc.text('ä¼æ¥­åŸºæœ¬è³‡è¨Š', 20, 50);
            doc.setFontSize(12);
            doc.text(`å“¡å·¥äººæ•¸: ${employees}äºº`, 25, 65);
            doc.text(`æ¯æœˆä¹˜è»Šæ¬¡æ•¸: ${trips}æ¬¡`, 25, 75);
            doc.text(`å¹³å‡æ¯è¶Ÿè»Šè³‡: ${avgCost}`, 25, 85);
            
            // è²¡å‹™åˆ†æ
            doc.setFontSize(14);
            doc.text('è²¡å‹™æ•ˆç›Šåˆ†æ', 20, 105);
            doc.setFontSize(12);
            doc.text(`æ¯æœˆè»Šè³‡ç¸½é¡: ${monthlyTotal}`, 25, 120);
            doc.text(`ç®¡ç†æœå‹™è²»: ${serviceFee}`, 25, 130);
            doc.text(`æ¯æœˆæ·¨ç¯€çœ: ${monthlySaving}`, 25, 140);
            doc.text(`å¹´åº¦æ·¨ç¯€çœ: ${annualSaving}`, 25, 150);
            
            // ROIåˆ†æ
            doc.setFontSize(14);
            doc.text('æŠ•è³‡å ±é…¬ç‡åˆ†æ', 20, 170);
            doc.setFontSize(12);
            doc.text(`æœˆåº¦ROI: ${monthlyROI}`, 25, 185);
            doc.text(`å¹´åº¦ROI: ${annualROI}`, 25, 195);
            doc.text(`é¢¨éšªè©•ä¼°: ${riskLevel}`, 25, 205);
            
            // çµè«–å»ºè­°
            doc.setFontSize(14);
            doc.text('å°ˆæ¥­å»ºè­°', 20, 225);
            doc.setFontSize(12);
            
            // åˆ†è¡Œé¡¯ç¤ºå»ºè­°æ–‡å­—
            const recommendationLines = doc.splitTextToSize(recommendation, 160);
            let yPos = 240;
            recommendationLines.forEach(line => {
                doc.text(line, 25, yPos);
                yPos += 10;
            });
            
            // æ•ˆç›Šæ‘˜è¦
            doc.setFontSize(14);
            doc.text('æ•ˆç›Šæ‘˜è¦', 20, yPos + 10);
            doc.setFontSize(11);
            doc.text('âœ“ è‡ªå‹•åŒ–å¸³å‹™è™•ç†ï¼Œæ¸›å°‘äººåŠ›æˆæœ¬', 25, yPos + 25);
            doc.text('âœ“ æœˆçµä»˜æ¬¾æ–¹å¼ï¼Œæ”¹å–„ç¾é‡‘æµ', 25, yPos + 35);
            doc.text('âœ“ é›»å­å¸³å–®ç®¡ç†ï¼Œæå‡ä½œæ¥­æ•ˆç‡', 25, yPos + 45);
            doc.text('âœ“ å°ˆå±¬å®¢æœæ”¯æ´ï¼Œä¿éšœæœå‹™å“è³ª', 25, yPos + 55);
            
            // å ±å‘Šæ—¥æœŸ
            const today = new Date().toLocaleDateString('zh-TW');
            doc.setFontSize(10);
            doc.text(`å ±å‘Šç”Ÿæˆæ—¥æœŸ: ${today}`, 20, 280);
            doc.text('55688å°ç£å¤§è»ŠéšŠä¼æ¥­æœƒå“¡æœå‹™', 120, 280);
            
            // å„²å­˜PDF
            doc.save('55688ä¼æ¥­æœƒå“¡ROIåˆ†æå ±å‘Š.pdf');
            
            // é¡¯ç¤ºå®Œæˆè¨Šæ¯
            alert('PDFå ±å‘Šå·²æˆåŠŸç”Ÿæˆä¸¦ä¸‹è¼‰ï¼\n\n' + 
                  `æŠ•è³‡å»ºè­°: ${recommendation}\n` +
                  `æœˆåº¦ROI: ${monthlyROI}\n` +
                  `å¹´åº¦ç¯€çœ: ${annualSaving}`);
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            calculateROI();
        });
    </script>
</body>
</html>
